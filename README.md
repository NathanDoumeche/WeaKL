# WeakL applied to time series

This project aims at illustring the results of the three use cases in the paper _Forecasting time series with constraint_ (Nathan Doumèche, Francis Bach, Eloi Bedek, Gérard Biau, Claire Boyer, and Yannig Goude).

## Install
To install packages used to generate the results in the paper, create a virtual environment using python 3.10.16. Then, run the following command in the terminal.
```bash
pip install -r requirements.txt
```
## Use case 1: The IEEE DataPort competition on day-ahead electricity load forecasting
Go to the corresponding directory and unzip the file _data\_corr.csv.zip_. 
- _WeakL.ipynb_ generates the forecasts of the WeakL model, which is a direct translation of the GAM-Viking into WeakL framework
- _aggregation_WeakL.R_ computes the performance of the different aggregation of expert. In the last aggregation, we substitute the forecasts of the GAM model with that of the WeakL model generated by _WeakL.ipynb_.
- _WeakL_99.py_ generates the forecasts of the pure WeakL model. A GPU with a good RAM memory is recommended (e.g. Tesla v100-SXM2-32GB) otherwise the generated tensors will exceed the GPU's capacity.
- _bootstrap_significative_test.R_ computes the significative test of the skill score of the pure WeakL model against the model of the winning team of the competition. More specifically, it computes the lower bound of the unilateral confidence interval with a risk of 10%.

2) Create a virtual environment with Python 3.9 and install the packages of _requirements.txt_.

## Use case 2: Forecasting the Frecnh electricity load during the energy crisis
Go to the corresponding directory and unzip the file _dataset_national.csv.zip_. 
